# 카드 터미널

## 구현

- 카드 터미널과의 통신 프로토콜을 확장성 있게 구현<br />
(내용물 기반으로 체크섬 자동 생성 및 확인)<br />
(패킷 구조에 따라 동적으로 페이로드를 파싱/생성할 수 있도록 구현)<br />
(Construct 패키지 활용)
- 거래 시작 요청 수신 및 응답 구현<br />
- 토큰 생성 요청 발신 및 응답 수신 구현<br />

## 구현 중 마주한 문제 혹은 물음점

- 거래시작 명령에 대한 응답은 필수적이지는 않으나 구현을 시도하였음<br />
응답 메시지 포맷을 스펙에 맞게 작성하였음에도 불구하고 전문오류가 발생함<br />
해당 오류의 원인을 파악하지 못하였음<br />
<br />
(PA, 20)에 대한 응답으로 (PA, 20, N\x1c\xb3\x1e전문오류\x1c)와 같은 형식으로 응답이 돌아옴<br />

- 거래 시작 요청을 수신하고 토큰 생성 요청을 발신하는 경우 CAT 기기로부터 많은 경우에 응답이 돌아오지 않았음<br />
만약 해당 상황이 실패 상황이라면 서버가 어떻게 처리해야 하는가에 대한 궁금점이 있음 (타임아웃?)<br />

- 정상적인 승인 과정은 어떻게 되는가?<br />
결국 카드가 꽂혔을 때 혹은 삼성 페이로 터치했을 때 열리는 시스템을 가정해야할 것 같은데<br />
토큰 승인이라면 먼저 VANKEY를 수신하고 나서 대기 후 결제를 진행하는 구조인지, 잔액 여부를 확인해야 한다면 어떻게 확인해야 하는지
삼성 페이라면 선승인 후 실제 금액 결제를 진행해야할 것 같은데 주어진 스펙에서 어떻게 진행해야할 지

VAN 승인 실패, 망상 취소 경우 D1, 20 응답이 안옴